# Forta setup guade
### Форма для ноды:
```https://docs.google.com/forms/d/e/1FAIpQLSfO1D7NLUcv-FsYKMcUlVwTUXAdmFraXqnXsmUA_qkSR2d79A/viewform?pli=1```

### Installation tutorial: Решил попробовать запустить на Light clietn of Etherium (not full node)


1. Ставим клиента отсюда, я выбрал через докер:
https://geth.ethereum.org/docs/install-and-build/installing-geth#run-inside-docker-container
```
# docker pull ethereum/client-go
# mkdir /root/.ethereum
# screen -S Etherium_noda
# docker run -it -p 30303:30303 -p 8545:8545 -p 8546:8546 -p 30304:30304 -v /root/.ethereum/:/root/.ethereum/ ethereum/client-go --syncmode light --http --http.addr 0.0.0.0 --http.port 8545
```
https://www.freecodecamp.org/news/how-to-run-geth-from-a-docker-container-b6d30620ca74/ 
https://ethereum.org/ru/developers/tutorials/run-light-node-geth/

### 2. Сетапим и настраиваем ноду Forta
### 2.1
```
# curl https://dist.forta.network/pgp.public -o /usr/share/keyrings/forta-keyring.asc -s
# echo 'deb [signed-by=/usr/share/keyrings/forta-keyring.asc] https://dist.forta.network/repositories/apt stable main' | sudo tee -a /etc/apt/sources.list.d/forta.list
# apt-get update
# apt-get install forta
```
### 2.2
```
# forta init --passphrase Blackwincen13
Scanner address: 0x4751ca9aa2EaA551d26d1993A14BbE05a5404049

Successfully initialized at /root/.forta

- Please make sure that all of the values in config.yml are set correctly.
- Please fund your scanner address with some MATIC.
- Please enable it for the chain ID in your config by doing 'forta register --owner-address <your_owner_wallet_address>'.
root@vmi621203:~#
```

### 2.3 Редактируем этот файл указывая наш лайт клиент сети Эфира:
```
root@vmi621203:~# cat /root/.forta/config.yml |head -n20
# Auto generated by 'forta init' - safe to modify
# The chainId is the chainId of the network that is analyzed (1=mainnet)
chainId: 1

# The scan settings are used to retrieve the transactions that are analyzed
scan:
  jsonRpc:
    url: http://127.0.0.1:8545

# The trace endpoint must support trace_block (such as alchemy)
trace:
  jsonRpc:
    url: http://127.0.0.1:8545

# The registry settings are used to discover and load agents
```
### 2.4 Registering Forta node
Пополняем наш адрес в сети Polygon на 1 MATIC и проверяем баланс:
https://polygonscan.com/address/0x4751ca9aa2EaA551d26d1993A14BbE05a5404049 

```
# forta register --owner-address 0x1418559Ea8b2d5A29Ce34A8c512c764F80A68D4A --passphrase Blackwincen13
Sending a transaction to register your scan node to chain 1...
Successfully sent the transaction!

Please ensure that https://polygonscan.com/tx/0xbca62d6b2e4c2d9068b6ec1bc251c8b23d6cd31fe42b33df829beea62d5f6adf succeeds before you do 'forta run'. This can take a while depending on the network load.
root@vmi621203:~#
```
### 2.5 Запускаем ноду
Перед запуском добавил переменные как описано тут:
To override systemd service environment, you can set the variables in /etc/systemd/system/forta.service.d/env.conf like:
```
[Service]
Environment="FORTA_DIR=<your_forta_config_dir>"
Environment="FORTA_PASSPHRASE=<your_forta_passphrase>"

Run the systemd service to start Forta

# systemctl enable forta
# systemctl start forta
```
### 2.6 Check status:
 ```
 # forta status

root@vmi621203:~# forta status
forta.container.forta-json-rpc.summary
⬤ ok

forta.container.forta-supervisor.summary
⬤ ok: all 3 service containers are running. telemetry sync is failing with error 'telemetry handler responded with '403': {"code":403,"message":"scanner is not authorized"}
' (non-critical).

forta.container.forta-updater.summary
⬤ ok

root@vmi621203:~#
```
